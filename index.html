<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Race Car Numbers!</title>
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    background: #1a1a2e;
    font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
    overflow: hidden;
    height: 100vh;
    width: 100vw;
    touch-action: manipulation;
    -webkit-user-select: none;
    user-select: none;
  }

  .sky {
    position: absolute;
    top: 0; left: 0; right: 0;
    height: 40%;
    background: linear-gradient(180deg, #0f0c29 0%, #302b63 50%, #24243e 100%);
  }

  .stars { position: absolute; inset: 0; }

  .star {
    position: absolute;
    background: #fff;
    border-radius: 50%;
    animation: twinkle 2s ease-in-out infinite alternate;
  }

  @keyframes twinkle { 0% { opacity: 0.3; } 100% { opacity: 1; } }

  .ground {
    position: absolute;
    bottom: 0; left: 0; right: 0;
    height: 60%;
    background: linear-gradient(180deg, #2d5a27 0%, #1e3d1a 100%);
  }

  .road {
    position: absolute;
    bottom: 5%;
    left: 0; right: 0;
    height: 55%;
    background: #333;
    overflow: hidden;
  }

  .lane-divider {
    position: absolute;
    left: 0; right: 0;
    top: 50%;
    height: 5px;
    transform: translateY(-50%);
    background: repeating-linear-gradient(90deg, #fff 0px, #fff 40px, transparent 40px, transparent 80px);
    opacity: 0.4;
  }

  .finish-line {
    position: absolute;
    right: 40px;
    top: 0; bottom: 0;
    width: 24px;
    background: repeating-conic-gradient(#fff 0% 25%, #111 0% 50%) 0 0 / 12px 12px;
    opacity: 0.7;
    z-index: 2;
  }

  /* Cars */
  .lane {
    position: absolute;
    left: 0; right: 0;
    height: 50%;
    display: flex;
    align-items: center;
  }

  .lane-top { top: 0; }
  .lane-bottom { bottom: 0; }

  .car-wrapper {
    position: absolute;
    left: 30px;
    cursor: pointer;
    transition: left 2s cubic-bezier(0.2, 0.8, 0.3, 1);
    z-index: 5;
    filter: drop-shadow(0 6px 12px rgba(0,0,0,0.5));
  }

  .car-wrapper:active { transform: scale(0.95); }
  .car-wrapper.winner { transition: left 1.8s cubic-bezier(0.1, 0.7, 0.3, 1); }
  .car-wrapper.loser { transition: left 2.5s cubic-bezier(0.1, 0.3, 0.5, 1); }

  .car {
    position: relative;
    width: 240px;
    height: 110px;
  }

  .car-body {
    position: absolute;
    bottom: 18px;
    left: 0;
    width: 240px;
    height: 65px;
    border-radius: 10px 40px 6px 6px;
    overflow: hidden;
  }

  .car-top {
    position: absolute;
    bottom: 65px;
    left: 55px;
    width: 120px;
    height: 42px;
    border-radius: 8px 20px 0 0;
  }

  .car-window {
    position: absolute;
    bottom: 70px;
    left: 78px;
    width: 38px;
    height: 30px;
    background: rgba(135, 206, 250, 0.6);
    border-radius: 4px 10px 0 0;
  }

  .car-window-back {
    position: absolute;
    bottom: 70px;
    left: 122px;
    width: 34px;
    height: 26px;
    background: rgba(135, 206, 250, 0.5);
    border-radius: 4px 6px 0 0;
  }

  .wheel {
    position: absolute;
    bottom: 2px;
    width: 38px;
    height: 38px;
    background: #222;
    border-radius: 50%;
    border: 4px solid #555;
  }

  .wheel::after {
    content: '';
    position: absolute;
    top: 50%; left: 50%;
    transform: translate(-50%, -50%);
    width: 12px;
    height: 12px;
    background: #888;
    border-radius: 50%;
  }

  .wheel-front { left: 168px; }
  .wheel-back { left: 28px; }

  .car-wrapper.winner .wheel,
  .car-wrapper.loser .wheel {
    animation: spin 0.3s linear infinite;
  }

  @keyframes spin { to { transform: rotate(360deg); } }

  /* Number + fuel inside car body */
  .car-interior {
    position: absolute;
    inset: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 12px;
    z-index: 2;
    pointer-events: none;
  }

  .car-number {
    font-size: 40px;
    font-weight: 900;
    color: #fff;
    text-shadow: 2px 2px 0 rgba(0,0,0,0.4);
    line-height: 1;
  }

  .fuel-gauge {
    width: 18px;
    height: 44px;
    background: rgba(0,0,0,0.35);
    border-radius: 4px;
    border: 2px solid rgba(255,255,255,0.25);
    position: relative;
    overflow: hidden;
  }

  .fuel-fill {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    border-radius: 0 0 2px 2px;
    transition: height 0.6s cubic-bezier(0.4, 0, 0.2, 1);
  }

  .fuel-fill.low {
    background: linear-gradient(180deg, #fb923c 0%, #ea580c 100%);
  }

  .fuel-fill.high {
    background: linear-gradient(180deg, #4ade80 0%, #16a34a 100%);
  }

  .fuel-icon {
    position: absolute;
    top: -16px;
    left: 50%;
    transform: translateX(-50%);
    font-size: 11px;
  }

  /* Prompt */
  .prompt {
    position: absolute;
    top: 2%;
    left: 50%;
    transform: translateX(-50%);
    z-index: 20;
    text-align: center;
    pointer-events: none;
  }

  .prompt-text {
    font-size: clamp(22px, 5vw, 40px);
    font-weight: 800;
    color: #fff;
    text-shadow: 0 2px 10px rgba(0,0,0,0.5);
  }

  .prompt-sub {
    font-size: clamp(14px, 3vw, 22px);
    color: #f0c040;
    margin-top: 4px;
    font-weight: 600;
  }

  /* Result */
  .result {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%) scale(0);
    z-index: 30;
    text-align: center;
    pointer-events: none;
    transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
  }

  .result.show { transform: translate(-50%, -50%) scale(1); }

  .result-emoji { font-size: clamp(60px, 15vw, 100px); }

  .result-text {
    font-size: clamp(28px, 6vw, 48px);
    font-weight: 900;
    color: #fff;
    text-shadow: 0 3px 15px rgba(0,0,0,0.5);
    margin-top: 8px;
  }

  .result-explain {
    font-size: clamp(18px, 4vw, 28px);
    color: #f0c040;
    font-weight: 700;
    margin-top: 4px;
  }

  /* Score */
  .score-bar {
    position: absolute;
    top: 12px;
    right: 16px;
    z-index: 20;
    display: flex;
    gap: 6px;
    align-items: center;
  }

  .trophy { font-size: 28px; }

  .score-num {
    font-size: 32px;
    font-weight: 900;
    color: #f0c040;
    text-shadow: 0 2px 6px rgba(0,0,0,0.4);
  }

  .streak-bar {
    position: absolute;
    top: 14px;
    left: 16px;
    z-index: 20;
    display: flex;
    gap: 5px;
  }

  .streak-dot {
    width: 16px;
    height: 16px;
    border-radius: 50%;
    background: rgba(255,255,255,0.15);
    transition: background 0.3s, transform 0.3s;
  }

  .streak-dot.lit {
    background: #4ade80;
    transform: scale(1.2);
    box-shadow: 0 0 8px rgba(74, 222, 128, 0.5);
  }

  .streak-dot.miss {
    background: #f87171;
    transform: scale(1.2);
  }

  .level-badge {
    position: absolute;
    bottom: 10px;
    left: 50%;
    transform: translateX(-50%);
    z-index: 20;
    background: rgba(0,0,0,0.4);
    color: #fff;
    padding: 5px 18px;
    border-radius: 20px;
    font-size: 14px;
    font-weight: 600;
    letter-spacing: 1px;
  }

  /* Exhaust */
  .exhaust {
    position: absolute;
    left: -8px;
    bottom: 28px;
    pointer-events: none;
    opacity: 0;
  }

  .car-wrapper.winner .exhaust,
  .car-wrapper.loser .exhaust { opacity: 1; }

  .puff {
    position: absolute;
    width: 14px;
    height: 14px;
    background: rgba(200, 200, 200, 0.4);
    border-radius: 50%;
    animation: puff 0.6s ease-out infinite;
  }

  .puff:nth-child(2) { animation-delay: 0.2s; }
  .puff:nth-child(3) { animation-delay: 0.4s; }

  @keyframes puff {
    0% { transform: translate(0, 0) scale(1); opacity: 0.5; }
    100% { transform: translate(-30px, -10px) scale(2.5); opacity: 0; }
  }

  .confetti-piece {
    position: fixed;
    z-index: 50;
    pointer-events: none;
  }

  @keyframes confetti-fall {
    0% { transform: translateY(-10px) rotate(0deg); opacity: 1; }
    100% { transform: translateY(100vh) rotate(720deg); opacity: 0; }
  }

  .clickable { cursor: pointer; }
</style>
</head>
<body>

<div class="sky">
  <div class="stars" id="stars"></div>
</div>
<div class="ground"></div>

<div class="road" id="road">
  <div class="finish-line"></div>
  <div class="lane-divider"></div>

  <div class="lane lane-top">
    <div class="car-wrapper clickable" id="car1" onclick="pick(0)">
      <div class="car">
        <div class="car-top" id="car1-top"></div>
        <div class="car-window"></div>
        <div class="car-window-back"></div>
        <div class="car-body" id="car1-body">
          <div class="car-interior">
            <span class="car-number" id="car1-num"></span>
            <div class="fuel-gauge"><div class="fuel-icon">‚õΩ</div><div class="fuel-fill" id="car1-fuel"></div></div>
          </div>
        </div>
        <div class="wheel wheel-front"></div>
        <div class="wheel wheel-back"></div>
        <div class="exhaust"><div class="puff"></div><div class="puff"></div><div class="puff"></div></div>
      </div>
    </div>
  </div>

  <div class="lane lane-bottom">
    <div class="car-wrapper clickable" id="car2" onclick="pick(1)">
      <div class="car">
        <div class="car-top" id="car2-top"></div>
        <div class="car-window"></div>
        <div class="car-window-back"></div>
        <div class="car-body" id="car2-body">
          <div class="car-interior">
            <span class="car-number" id="car2-num"></span>
            <div class="fuel-gauge"><div class="fuel-icon">‚õΩ</div><div class="fuel-fill" id="car2-fuel"></div></div>
          </div>
        </div>
        <div class="wheel wheel-front"></div>
        <div class="wheel wheel-back"></div>
        <div class="exhaust"><div class="puff"></div><div class="puff"></div><div class="puff"></div></div>
      </div>
    </div>
  </div>
</div>

<div class="prompt" id="prompt">
  <div class="prompt-text">Which car has MORE fuel?</div>
  <div class="prompt-sub">Tap the car with the bigger number!</div>
</div>

<div class="result" id="result">
  <div class="result-emoji" id="result-emoji"></div>
  <div class="result-text" id="result-text"></div>
  <div class="result-explain" id="result-explain"></div>
</div>

<div class="score-bar">
  <span class="trophy">üèÜ</span>
  <span class="score-num" id="score">0</span>
</div>

<div class="streak-bar" id="streak-bar"></div>
<div class="level-badge" id="level-badge"></div>

<script>
(function() {
  const LEVELS = [
    { name: 'Easy Peasy',      min: 1,   max: 9,    minGap: 3 },
    { name: 'Getting Tricky',  min: 1,   max: 20,   minGap: 3 },
    { name: 'Big Numbers!',    min: 10,  max: 50,   minGap: 5 },
    { name: 'Super Racer',     min: 10,  max: 100,  minGap: 5 },
    { name: 'Number Champion', min: 50,  max: 200,  minGap: 10 },
    { name: 'MEGA BRAIN',      min: 100, max: 500,  minGap: 15 },
    { name: 'ULTIMATE!',       min: 100, max: 999,  minGap: 20 },
  ];

  const CAR_COLORS = [
    { body: '#e63946', top: '#c1121f' },
    { body: '#457b9d', top: '#1d3557' },
    { body: '#f77f00', top: '#e36414' },
    { body: '#2a9d8f', top: '#1a7a6e' },
    { body: '#7209b7', top: '#560bad' },
    { body: '#e76f51', top: '#c44536' },
    { body: '#06d6a0', top: '#05a87d' },
    { body: '#ef476f', top: '#c9184a' },
  ];

  let score = 0, level = 0, streak = 0, maxStreak = 0, nums = [0,0], locked = false;
  let roundHistory = [];

  const car1El = document.getElementById('car1');
  const car2El = document.getElementById('car2');
  const promptEl = document.getElementById('prompt');
  const resultEl = document.getElementById('result');
  const scoreEl = document.getElementById('score');
  const streakBar = document.getElementById('streak-bar');
  const levelBadge = document.getElementById('level-badge');

  // Stars
  const starsEl = document.getElementById('stars');
  for (let i = 0; i < 60; i++) {
    const s = document.createElement('div');
    s.className = 'star';
    s.style.left = Math.random() * 100 + '%';
    s.style.top = Math.random() * 100 + '%';
    s.style.width = s.style.height = (1 + Math.random() * 2) + 'px';
    s.style.animationDelay = Math.random() * 2 + 's';
    starsEl.appendChild(s);
  }

  // Streak dots
  for (let i = 0; i < 5; i++) {
    const d = document.createElement('div');
    d.className = 'streak-dot';
    streakBar.appendChild(d);
  }

  function randInt(a, b) { return Math.floor(Math.random() * (b - a + 1)) + a; }

  function pickColors() {
    const s = [...CAR_COLORS].sort(() => Math.random() - 0.5);
    return [s[0], s[1]];
  }

  function generateNumbers() {
    const lv = LEVELS[level];
    let a, b;
    do {
      a = randInt(lv.min, lv.max);
      b = randInt(lv.min, lv.max);
    } while (a === b || Math.abs(a - b) < lv.minGap);
    return [a, b];
  }

  function getCeiling(biggest) {
    if (biggest <= 10) return 10;
    if (biggest <= 20) return 20;
    if (biggest <= 50) return 50;
    if (biggest <= 100) return 100;
    if (biggest <= 200) return 200;
    if (biggest <= 500) return 500;
    return 1000;
  }

  function updateStreakBar() {
    const dots = streakBar.querySelectorAll('.streak-dot');
    dots.forEach((d, i) => {
      d.className = 'streak-dot';
      if (i < roundHistory.length) d.classList.add(roundHistory[i] ? 'lit' : 'miss');
    });
  }

  function confetti() {
    const colors = ['#f0c040','#e63946','#06d6a0','#457b9d','#f77f00','#7209b7','#ef476f'];
    for (let i = 0; i < 40; i++) {
      const c = document.createElement('div');
      c.className = 'confetti-piece';
      c.style.left = Math.random() * 100 + 'vw';
      c.style.top = '-10px';
      c.style.background = colors[Math.random() * colors.length | 0];
      c.style.borderRadius = Math.random() > 0.5 ? '50%' : '2px';
      c.style.width = (6 + Math.random() * 8) + 'px';
      c.style.height = (6 + Math.random() * 8) + 'px';
      c.style.animation = `confetti-fall ${1.5 + Math.random() * 2}s ease-out forwards`;
      c.style.animationDelay = Math.random() * 0.5 + 's';
      document.body.appendChild(c);
      setTimeout(() => c.remove(), 4000);
    }
  }

  function newRound() {
    locked = false;
    resultEl.classList.remove('show');
    promptEl.style.opacity = '1';

    car1El.style.transition = 'none';
    car2El.style.transition = 'none';
    car1El.style.left = '30px';
    car2El.style.left = '30px';
    car1El.className = 'car-wrapper clickable';
    car2El.className = 'car-wrapper clickable';

    const [c1, c2] = pickColors();
    document.getElementById('car1-body').style.background = c1.body;
    document.getElementById('car1-top').style.background = c1.top;
    document.getElementById('car2-body').style.background = c2.body;
    document.getElementById('car2-top').style.background = c2.top;

    nums = generateNumbers();
    document.getElementById('car1-num').textContent = nums[0];
    document.getElementById('car2-num').textContent = nums[1];

    // Fuel gauge
    const ceiling = getCeiling(Math.max(nums[0], nums[1]));
    const gaugeH = 40; // px inner height
    const pct1 = nums[0] / ceiling;
    const pct2 = nums[1] / ceiling;

    const fuel1 = document.getElementById('car1-fuel');
    const fuel2 = document.getElementById('car2-fuel');
    fuel1.style.height = Math.max(3, pct1 * gaugeH) + 'px';
    fuel2.style.height = Math.max(3, pct2 * gaugeH) + 'px';
    fuel1.className = 'fuel-fill ' + (pct1 < 0.4 ? 'low' : 'high');
    fuel2.className = 'fuel-fill ' + (pct2 < 0.4 ? 'low' : 'high');

    levelBadge.textContent = LEVELS[level].name;
  }

  function showResult(correct, winnerNum, loserNum) {
    const emoji = document.getElementById('result-emoji');
    const text = document.getElementById('result-text');
    const explain = document.getElementById('result-explain');

    if (correct) {
      const phrases = ['VROOM VROOM!','SPEED DEMON!','TURBO BOOST!','ZOOM ZOOM!','NITRO!','WINNER!'];
      emoji.textContent = ['üèéÔ∏è','üöÄ','‚ö°','üî•','üí®','üèÅ'][Math.random() * 6 | 0];
      text.textContent = phrases[Math.random() * phrases.length | 0];
      text.style.color = '#4ade80';
    } else {
      emoji.textContent = 'üí•';
      text.textContent = 'Oops!';
      text.style.color = '#f87171';
    }
    explain.textContent = winnerNum + ' is bigger than ' + loserNum + '!';
    resultEl.classList.add('show');
  }

  window.pick = function(idx) {
    if (locked) return;
    locked = true;
    promptEl.style.opacity = '0';
    car1El.classList.remove('clickable');
    car2El.classList.remove('clickable');

    const biggerIdx = nums[0] > nums[1] ? 0 : 1;
    const correct = idx === biggerIdx;
    const winnerEl = biggerIdx === 0 ? car1El : car2El;
    const loserEl = biggerIdx === 0 ? car2El : car1El;

    const road = document.getElementById('road');
    const roadWidth = road.offsetWidth;

    requestAnimationFrame(() => {
      winnerEl.style.transition = 'left 1.8s cubic-bezier(0.2, 0.8, 0.3, 1)';
      loserEl.style.transition = 'left 2.5s cubic-bezier(0.1, 0.3, 0.5, 1)';
      winnerEl.classList.add('winner');
      loserEl.classList.add('loser');
      winnerEl.style.left = (roadWidth - 140) + 'px';
      loserEl.style.left = (roadWidth * 0.4) + 'px';
    });

    if (correct) {
      score++; streak++;
      if (streak > maxStreak) maxStreak = streak;
      scoreEl.textContent = score;
      roundHistory.push(true);
      if (streak > 0 && streak % 5 === 0 && level < LEVELS.length - 1) level++;
    } else {
      streak = 0;
      roundHistory.push(false);
      if (roundHistory.length >= 3) {
        const wrongs = roundHistory.slice(-3).filter(x => !x).length;
        if (wrongs >= 2 && level > 0) level--;
      }
    }

    if (roundHistory.length > 5) roundHistory.shift();
    updateStreakBar();

    const winNum = nums[biggerIdx], loseNum = nums[1 - biggerIdx];
    setTimeout(() => { showResult(correct, winNum, loseNum); if (correct) confetti(); }, 1200);
    setTimeout(newRound, correct ? 3500 : 3000);
  };

  newRound();
})();
</script>
</body>
</html>
